<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Pinchart</title>
    <link rel="stylesheet" href="./common.css">
</head>
<body>
    <div class="page"></div>

    <script src="./three.min.js"></script>
    <script src="PinChart.js"></script>
    <script>

        CameraControls.install({
            THREE: THREE
        })
        var control
        var scene = new THREE.Scene();
        var camera
        let raycaster = new THREE.Raycaster()
        //  let fullWidth = window.innerWidth
        //  let fullHeight = window.innerHeight
        let fullWidth = 250
        let fullHeight = 190

        initCamera()

        var renderer = new THREE.WebGLRenderer({
            antialias: true,
            alpha: true
        });

        renderer.setClearColor(new THREE.Color(0x000000), 0)
        // renderer.shadowMapEnabled = true

        renderer.setSize(fullWidth, fullHeight);
        document.querySelector('.app').appendChild(renderer.domElement);
        var clock = new THREE.Clock()

        // 缩放重置相机.
        window.addEventListener('resize', resetSize, false)

        // 鼠标移动事件.
        let mouse_position = new THREE.Vector2()
        let select_object = null
        document.querySelector('.app').addEventListener('mousemove', function(e) {
            let x = e.offsetX
            let y = e.offsetY
            let dx = (x / fullWidth) * 2 - 1
            let dy = 1 - (y / fullHeight) * 2

            mouse_position.set(dx, dy)

            switchSelectObject()
        }, false)

        document.querySelector('.app').addEventListener('click', function(e) {
            let x = e.offsetX
            let y = e.offsetY
            let dx = (x / fullWidth) * 2 - 1
            let dy = 1 - (y / fullHeight) * 2

            mouse_position.set(dx, dy)

            switchSelectObject()

        }, false)

        initLight()
        initOrbitControls()

        var json = []
        var fontColor = ['#9F8FE7', '#6495FB', '#FAE672', '#FB4E6A', '#B93DAD']
        var allcolor = [0x9F8FE7, 0x6495FB, 0xFAE672, 0xFB4E6A, 0xB93DAD]
        var allheight = [6, 5, 4,3, 2]
        var alldomOffset = [
            [-15, -25],
            [-15, -15],
            [-20, 30],
            [30, 30],
            [30, -20]
        ]
        var all = 0;
        var dayTypeList = [{id: 1, typeName: "",}];

        dayTypeList.forEach(function(i, e) {
            all += (e.id - 0)
        })
        dayTypeList.forEach(function(i, e) {
            json.push({
                name: e.typeName,
                value: (Math.round(e.id / all * 100)),
                color: allcolor[i],
                height:allheight[i],
                domOffset: alldomOffset[i],
                fontColor: fontColor[i]
            })
        })
        initChart(json)
    </script>
</body>
</html>